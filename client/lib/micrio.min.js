/* Micrio.min.js, R1163209674a4490a59f28e1cdbbaca29924278f4/1441632943+
 * Copyright (C) Q42 Internet B.V. - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * Written by Marcel Duin <marcel@q42.nl>, 2015
 */
(function(){function c(a){this.data=a;this.id=a.id;this.width=a.width;this.height=a.height;this.path=a.path||"http://bin.micr.io/public/";this.L=a.tileSize||a.zoomify&&256||512;this.Ub=!1!==a.hookEvents;this.Ra="cover"==a.initType;this.Hb=!1!==a.autoInit;this.J=a.json||{};this.W=!a.noLevel0&&1||0;this.cc=a.zoomify;this.Jb=a.doubleClickZoomOut;this.za=navigator.h.ie9||navigator.h.iOS&&navigator.h.mobile;this.Wa=navigator.h.ie||navigator.h.firefox||navigator.h.safari;this.Kb=this.za&&1||1;this.aspect=
this.width/this.height;for(var b=this.L;b<Math.max(this.width,this.height);b*=2,this.W++);this.ratio=this.Y=window.devicePixelRatioIEMobile||!this.za&&!a.noRetina&&window.devicePixelRatio&&Math.min(2,window.devicePixelRatio)||1;this.el=this.i=a.canvas instanceof Element&&a.canvas||document.getElementById(this.id)||document.createElement("canvas");this.i.classList.add("micrio");this.i.offset={top:0,left:0};this.i.micrio=this;this.container=this.e=a.container||this.i.parentNode||document.body;this.e.classList.add("micrio-container");
this.ma=this.i.getContext("2d");this.i.parentNode&&this.e==this.i.parentNode||this.e.appendChild(this.i);this.camera=this.f=new c.g(this);c.Eb&&(this.audio=this.gb=new c.Eb(this));c.Fb&&this.J.pointsOfInterest&&(this.pointsOfInterest=this.l=new c.Fb(this));this.thumbSrc=this.path+this.id+"/"+(this.W-1)+"/0-0.jpg";this.F=[];this.ya=this.C=this.Sa=!1;this.Hb&&this.P()}function q(a){var b="",e;for(e in s)b+=a.replace(/\$/,s[e]);return b}function n(a,b,e,c){var h=3*a,d=3*(e-a)-h,f=1-h-d,g=3*b,l=3*(c-
b)-g,w=1-g-l;return function(a){for(var b=a,e=0,c;2>e;){c=b*(h+b*(d+b*f))-a;if(0.001>Math.abs(c))break;b-=c/(h+b*(2*d+3*f*b));e++}a=b;return a*(g+a*(l+a*w))}}(function(){for(var a=0,b=["ms","moz","webkit","o"],e=0;e<b.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[b[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[e]+"CancelAnimationFrame"]||window[b[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var e=
(new Date).getTime(),c=Math.max(0,16-(e-a)),d=window.setTimeout(function(){b(e+c)},c);a=e+c;return d});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})})();window.performance||(window.performance={});window.performance.now||(window.performance.now=Date.now);if("undefined"!==typeof window.Element&&!("classList"in document.documentElement)){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var e=b||0,c=this.length;e<c;e++)if(this[e]===a)return e;
return-1});var d=Array.prototype,t=d.indexOf,u=d.slice,v=d.push,x=d.splice,y=d.join,r=function(a){this.fb=a;if("string"==typeof a.className&&a.className!=this.Ha&&(this.Ha=a.className)){a=this.Ha.replace(/^\s+|\s+$/g,"").split(/\s+/);var b;for(b=0;b<a.length;b++)v.call(this,a[b])}};r.prototype={add:function(a){this.contains(a)||(v.call(this,a),a=u.call(this,0),this.fb.className=a.join(" "))},contains:function(a){return-1!==t.call(this,a)},remove:function(a){a=t.call(this,a);-1!==a&&(x.call(this,a,
1),a=u.call(this,0),this.fb.className=a.join(" "))},toString:function(){return y.call(this," ")}};window.DOMTokenList=r;(function(a,b,e){Object.defineProperty?Object.defineProperty(a,b,{get:e}):a.__defineGetter__(b,e)})(window.Element.prototype,"classList",function(){return new r(this)})}if(navigator.userAgent&&(d=navigator.userAgent.toLowerCase(),/msie/.test(d)||/rv\:11\.0/.test(d)||!window.dc)){var p=function(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");
e.initCustomEvent(a,b.bubbles,b.cancelable,b.detail);return e};p.prototype=window.CustomEvent&&window.CustomEvent.prototype||window.Event.prototype;window.CustomEvent=p}Math.Ea=function(a,b){return Math.sqrt(a*a+b*b)};d=navigator.userAgent.toLowerCase();navigator.h={};navigator.h.webkit=/applewebkit/.test(d);navigator.h.firefox=/firefox/.test(d);navigator.h.safari=/safari/.test(d)&&!/chrome/.test(d);navigator.h.ie=/msie/.test(d)||/trident/.test(d)||/edge\//.test(d);navigator.h.iemobile=/iemobile/.test(d);
navigator.h.iOS=/ipad|iphone|ipod/.test(d);navigator.h.android=/android/.test(d);navigator.h.ie9=navigator.h.ie&&/ie 9/.test(d);navigator.h.iPad=/ipad/.test(d);navigator.h.mobile=navigator.h.iOS||navigator.h.android||navigator.h.iemobile;navigator.h.unknown=!navigator.h.webkit&&!navigator.h.firefox&&!navigator.h.ie&&!navigator.h.iOS&&!navigator.h.android;d={};d.transform="webkitTransform"in document.documentElement.style?"webkitTransform":"mozTransform"in document.documentElement.style?"mozTransform":
"msTransform"in document.documentElement.style?"msTransform":"transform";d.translate3d=navigator.h.ie9?["translate(",")"]:["translate3d(",",0)"];d.scale3d=navigator.h.ie9?["scale(",")"]:["scale3d(",",1)"];window.CSS=d;navigator.browser=navigator.h;navigator.h.iemobile&&(window.fc=Math.round(window.screen.availWidth/document.documentElement.clientWidth));c.prototype={P:function(){if(!this.Sa){this.Sa=!0;for(var a=0;a<this.W;a++)this.F.push(new c.ca(this,a));for(a=this.W-1;0<=a;a--)this.F[a].Bb=a<this.W-
1&&this.F[a+1].Bb+this.F[a+1].Vb||0;this.f.P();this.l&&this.l.P();return this.show()}},show:function(){if(!this.Sa)return this.P();if(this.C)return new Promise(function(a,b){b&&b("Already shown")});this.C=!0;this.e.appendChild(this.i);this.f.start();this.gb&&this.gb.P();this.l&&this.l.ic();this.f.va();return this.Gb=new Promise(function(a,b){this.ya?a.bind(this)():(this.i.addEventListener("loaded",a.bind(this)),b&&this.i.addEventListener("error",b.bind(this)))}.bind(this))},Tb:function(){this.C&&
(this.C=!1,this.e.removeChild(this.i),this.l&&this.l.remove(),this.f.stop(),this.f.Ga())},N:function(){var a=!1,b=!1,e=[],c=[],d=this.Y,k=this.F.filter(function(a){return a.a.scale>=0.5/d});k.length||(k=[this.F[this.F.length-1]]);for(var f=0,g,l;f<k.length;f++)if(g=k[f].qb(),l=g.filter(function(a){return a&&a.loaded}),e=e.concat(l),c=c.concat(g.filter(function(a){return a&&!a.src})),l.filter(function(a){return 1==a.opacity}).length==g.length){a=0==f;break}this.Wa&&k[f+1]&&(e=e.concat(k[f+1].qb().filter(function(a){return a&&
a.loaded})));e.reverse();c.reverse();for(f=0;f<e.length;f++)e[f].N(),1>e[f].opacity&&(b=!0);for(f=0;f<this.Kb&&f<c.length;f++)c[f].load();!a||b?this.f.H():this.ya||(this.ya=!0,this.i.classList.add("loaded"),this.i.dispatchEvent(new p("loaded",{detail:this.b})))}};window.Micrio=c;c.prototype.show=c.prototype.show;c.prototype.hide=c.prototype.Tb;c.ca=function(a,b){this.b=a;this.Va=b;this.J=this.b.J&&this.b.J.levels&&this.b.J.levels[b];this.scale=Math.pow(2,b);this.Cb=[];this.Ta=[];this.a={scale:1,v:[0,
0,0,0]};this.L=a.L*this.scale;this.qa=[Math.ceil(a.width/this.L),Math.ceil(a.height/this.L)];this.Vb=this.qa[0]*this.qa[1];this.Fa=[this.L/this.b.width,this.L/this.b.height]};c.ca.prototype={qb:function(){this.Ta=[];var a=this.b.f.Ja;this.a.v[0]=Math.floor(a[0][0]/this.Fa[0]);this.a.v[1]=Math.ceil(a[1][0]/this.Fa[0]);this.a.v[2]=Math.floor(a[0][1]/this.Fa[1]);this.a.v[3]=Math.floor(a[1][1]/this.Fa[1]);for(var b=a=0;this.a.v[2]-1<this.a.v[3];this.a.v[2]++)for(b=this.a.v[0],a=this.qa[0]*this.a.v[2];b<
this.a.v[1];b++)this.Ta.push(this.Cb[a+b]||(this.Cb[a+b]=new c.ca.eb(this,b,this.a.v[2],this.J&&this.J.tiles[a+b])));return this.Ta}};c.ca.eb=function(a,b,e,c){this.s=a;this.x=b;this.y=e;this.J=c;this.loaded=!1;this.wb=0;this.opacity=(a.b.za||!a.b.ya)&&1||0;this.height=this.width=0;this.Zb=b*this.s.b.L;this.$b=e*this.s.b.L;this.V=new Image;this.V.onload=this.onload.bind(this)};c.ca.eb.prototype={load:function(){var a=this.s.b,b=this.s,e=this.J,c=this.x,d=this.y;this.src=this.V.src=e&&e.url||a.path+
a.id+"/"+(a.data.isMontBlanc?a.W-b.Va+7+"/"+c+"_"+d+".jpeg":a.cc?"TileGroup"+Math.floor((b.Bb+d*b.qa[0]+c)/256)+"/"+(a.W-b.Va-1)+"-"+c+"-"+d+".jpg":b.Va+"/"+c+"-"+d+".jpg")},onload:function(){this.width=this.V.naturalWidth||this.V.height;this.height=this.V.naturalHeight||this.V.width;this.loaded=!0;this.wb=performance.now()},N:function(a,b){this.loaded&&(a=a||this.s.b.f.j*this.s.scale,b=b||this.s.b.f.offset,this.s.b.za||(1>this.opacity&&(this.opacity=Math.min(1,(performance.now()-this.wb)/250)),this.s.b.ma.globalAlpha=
this.opacity),this.s.b.ma.drawImage(this.V,this.Zb*a-b[0],this.$b*a-b[1],this.s.b.Wa&&this.width*a+1||this.width*a,this.s.b.Wa&&this.height*a+1||this.height*a))}};var d=document.createElement("style"),s=["-webkit-","-moz-","-ms-",""];d.textContent=".micrio-container{"+q("$user-select:none;")+"-ms-content-zooming:none;-ms-touch-action:none;touch-action:none;}.micrio-container.hooked{cursor:move;"+q("cursor:$grab;")+"}.micrio-container.dragging{"+q("cursor:$grabbing;")+"}.micrio-container.fullscreen{width:100%;height:100%;}";
document.head.appendChild(d);c.Camera=c.g=function(a){this.b=a;this.offset=[0,0];this.position={x:0,y:0,z:0};this.G=Math.min(this.b.e.offsetWidth/this.b.width,this.b.e.offsetHeight/this.b.height);this.la=Math.max(this.b.e.offsetWidth/this.b.width,this.b.e.offsetHeight/this.b.height);this.j=a.Ra?this.la:this.G;this.paused=!1;this.sb=this.j;this.ka=this.X=this.U=!1;this.Ja=null;this.w=[0,0,0];this.xb="";this.Ia={left:0,top:0}};c.g.prototype={P:function(){c.g.Q&&(this.events=this.m=new c.g.Q(this));
this.p=new c.g.cb;this.N=this.N.bind(this);this.reset=this.reset.bind(this);this.ta=this.ta.bind(this);this.lb();this.onresize=this.onresize.bind(this);this.onresize()},start:function(){this.m&&(this.m.ea(),this.m.a.hash.Ib||(this.K(this.j),this.b.Ra?this.$([0.5,0.5]):this.t(0,0)));this.onresize()},stop:function(){this.p.stop();this.paused=!1;this.m&&this.m.stop()},pause:function(){this.p.pause()},Za:function(){this.p.Za()},va:function(){this.m&&this.b.Ub&&this.m.va();addEventListener("resize",this.onresize)},
Ga:function(){this.m&&this.m.Ga();removeEventListener("resize",this.onresize);document.removeEventListener(this.n.onchange,this.ta)},sa:function(a,b,e,c,d){this.stop();var k=this.D([this.b.e.offsetWidth/2,this.b.e.offsetHeight/2]),f=0,g=0,l=k[0],n=k[1],p=this.j,q=e>p;c=void 0!==c?c:1E4*Math.Ea(this.w[2]-e,Math.Ea(this.w[0]-a,this.w[1]-b))*(1/d);return this.p.add(this.position,{},c,function(c){f=m.ib(c);g=(q&&m.ac||m.bc)(c);this.position.x=l*(1-f)+a*f;this.position.y=n*(1-f)+b*f;this.position.z=p*
(1-g)+e*g;this.K(this.position.z);this.$([this.position.x,this.position.y],!0,!0);this.H()}.bind(this))},Pb:function(a){a=this.j==this.G?0:a||1E3;return this.b.f.sa(0.5,0.5,this.b.f.G,a)},Ob:function(a){a=this.j==this.G?0:a||1E3;return this.b.f.sa(0.5,0.5,this.b.f.la,a)},Ma:function(a,b,c,d,h,k){this.stop();var f=this.D([this.b.e.offsetWidth/2,this.b.e.offsetHeight/2]),g={};void 0!==a&&(g.x=a);void 0!==b&&(g.y=b);void 0!==c&&(g.z=Math.min(h&&Infinity||1,Math.max(0,c)));this.position.x=f[0];this.position.y=
f[1];this.position.z=this.j;return this.p.add(this.position,g,d||5E3,function(){this.K(this.position.z,h);this.$([this.position.x,this.position.y],!0);this.H()}.bind(this),k)},reset:function(){this.K(this.sb);this.$([0.5,0.5])},D:function(a,b,c){c?(this.Ia=this.Oa(),a[0]-=this.Ia.left-(window.scrollX||window.pageXOffset),a[1]-=this.Ia.top-(window.scrollY||window.pageYOffset)):b&&(a[0]-=this.b.i.offset.left-(window.scrollX||window.pageXOffset),a[1]-=this.b.i.offset.top-(window.scrollY||window.pageYOffset));
return[Math.max(0,Math.min(this.b.width,(this.offset[0]+a[0])/this.j)/this.b.width),Math.max(0,Math.min(this.b.height,(this.offset[1]+a[1])/this.j)/this.b.height),this.j]},$:function(a,b,c){this.b.l&&(this.b.l.tb&&this.b.l.C&&!this.b.f.p.I&&(c=!0))&&(a=this.b.l.C.hc(a));this.t((this.position.x=a[0])*this.b.width*this.j-this.b.e.offsetWidth/2,(this.position.y=a[1])*this.b.height*this.j-this.b.e.offsetHeight/2,!0,c,this.b.l&&this.b.l.C);b||this.H();return!0},Rb:function(){return this.w},ua:function(a,
b){return[a[0]*this.b.width*this.j-this.offset[0]+(b&&this.b.i.offset.left-(window.scrollX||window.pageXOffset)||0),a[1]*this.b.height*this.j-this.offset[1]+(b&&this.b.i.offset.top-(window.scrollY||window.pageYOffset)||0)]},pb:function(){return[this.D([0,0]),this.D([this.b.e.offsetWidth,this.b.e.offsetHeight])]},t:function(a,b,c,d,h){if(!h&&this.b.l&&this.b.l.tb&&this.b.l.C&&!this.b.f.p.I)return this.$(this.D([this.b.e.offsetWidth/2+(c?0:a),this.b.e.offsetHeight/2+(c?0:b)]),!1,d);d?(this.offset[0]=
a+(c?0:this.offset[0]),this.offset[1]=b+(c?0:this.offset[1])):(d=this.b.width*this.j-this.b.e.offsetWidth,h=this.b.height*this.j-this.b.e.offsetHeight,this.offset[0]=Math.max(0,Math.min(d,a+(c?0:this.offset[0])))+(0>d&&d/2||0),this.offset[1]=Math.max(0,Math.min(h,b+(c?0:this.offset[1])))+(0>h&&h/2||0));this.Ja=this.pb();return!0},K:function(a,b){if(this.b.l&&this.b.l.C&&!this.b.f.p.I&&a<this.b.l.C.ec)return!1;this.j=Math.max(this.G,Math.min(b&&Infinity||1,a));for(var c=0;c<this.b.F.length;c++)this.b.F[c].a.scale=
this.j*this.b.F[c].scale;return!0},N:function(){this.Ja=this.pb();this.w=this.D([this.b.e.offsetWidth/2,this.b.e.offsetHeight/2]);this.b.ma.clearRect(0,0,this.b.i.width,this.b.i.height);this.b.N();this.w.join(",")!=this.xb&&(this.b.l&&this.b.l.draw(),this.b.i.dispatchEvent(new p("move",{detail:this.w})));this.xb=this.w.join(",")},H:function(){cancelAnimationFrame(this.S);this.S=requestAnimationFrame(this.N)},zoom:function(a,b){var c=this.b.e.offsetWidth/this.b.width,d=0.5*this.j/c,h=this.D([this.b.e.offsetWidth/
2,this.b.e.offsetHeight/2]);this.K(this.j+c/3*d*(a/120));b&&(c=this.ua(h),this.t(c[0]-this.b.e.offsetWidth/2,c[1]-this.b.e.offsetHeight/2))},Oa:function(a){var b={top:0,left:0};a=a||this.b.i;do b.top+=a.offsetTop||0,b.left+=a.offsetLeft||0,a=a.offsetParent;while(a&&(!this.n||!this.n.T));return b},onresize:function(a){if(!0===a||!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)||this.n.T)this.b.i.width=this.b.e.offsetWidth*
this.b.Y,this.b.i.height=this.b.e.offsetHeight*this.b.Y,1!=this.b.Y&&(this.b.i.style.width=this.b.e.offsetWidth+"px",this.b.i.style.height=this.b.e.offsetHeight+"px"),this.b.i.offset=this.Oa(),this.G=Math.min(this.b.e.offsetWidth/this.b.width,this.b.e.offsetHeight/this.b.height),this.la=Math.max(this.b.e.offsetWidth/this.b.width,this.b.e.offsetHeight/this.b.height),this.sb=this.b.Ra?this.la:this.G,this.K(this.j),this.t(this.offset[0],this.offset[1],!0),1<this.b.Y&&this.b.ma.setTransform(this.b.Y,
0,0,this.b.Y,0,0),this.H()},lb:function(){this.mb||(this.mb=!0,this.n={T:!1,bb:!1,ha:this.b.e.requestFullScreen||this.b.e.webkitRequestFullScreen||this.b.e.mozRequestFullScreen||this.b.e.msRequestFullscreen,Na:document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen,onchange:"onwebkitfullscreenchange"in document?"webkitfullscreenchange":"onmozfullscreenchange"in document?"mozfullscreenchange":"onmsfullscreenchange"in document?"MSFullscreenChange":
"onfullscreenchange"in document?"fullscreenchange":null},this.n.ha?(this.n.ha=this.n.ha.bind(this.b.e),this.n.Na=this.n.Na.bind(document),document.addEventListener(this.n.onchange,this.ta)):this.b.e.classList.add("no-fullscreen"))},ta:function(){this.n.T=(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)==this.b.e;this.b.e.classList[this.n.T&&"add"||"remove"]("fullscreen");this.n.T?(this.onresize(),this.n.bb=!0):this.n.bb&&(this.n.bb=
!1,setTimeout(this.reset))},Qb:function(){this.mb||this.lb();if(!this.n.ha)return console.warn("Your browser does not support full screen");this.n.T?this.n.Na():this.n.ha()},Sb:function(){return this.w[0].toPrecision(4)+","+this.w[1].toPrecision(4)+","+this.w[2].toPrecision(4)}};c.g.prototype.getXY=c.g.prototype.ua;c.g.prototype.getCurrentCoo=c.g.prototype.Rb;c.g.prototype.getRenderedOffset=c.g.prototype.Oa;c.g.prototype.flyTo=c.g.prototype.sa;c.g.prototype.flyToFullView=c.g.prototype.Pb;c.g.prototype.flyToCoverView=
c.g.prototype.Ob;c.g.prototype.easeTo=c.g.prototype.Ma;c.g.prototype.setCoo=c.g.prototype.$;c.g.prototype.reset=c.g.prototype.reset;c.g.prototype.setScale=c.g.prototype.K;c.g.prototype.draw=c.g.prototype.N;c.g.prototype.pause=c.g.prototype.pause;c.g.prototype.resume=c.g.prototype.Za;c.g.prototype.onresize=c.g.prototype.onresize;c.g.prototype.fullScreenToggle=c.g.prototype.Qb;c.g.prototype.getHash=c.g.prototype.Sb;c.g.cb=function(){this.paused=this.I=!1;this.B=[];this.step=this.step.bind(this);this.S=
null;this.R=0};c.g.cb.prototype={step:function(a){this.R||(this.R=a);for(var b,c,d,h=0;h<this.B.length;h++){c=this.B[h];d=Math.min(1,(c.vb+=a-this.R)/c.Lb);c.kb&&(d=c.kb(d));for(b in c.target)c.ub[b]=c.Yb[b]*(1-d)+c.target[b]*d;1<=d&&(c.Ya&&c.Ya(c),this.B.splice(h--,1));c.Ab&&c.Ab(d)}this.R=a;this.B.length?this.S=requestAnimationFrame(this.step):this.stop()},start:function(){this.I||(this.I=!0,this.S=requestAnimationFrame(this.step))},stop:function(){if(this.I){this.paused=this.I=!1;for(cancelAnimationFrame(this.S);this.B.length;)this.B.shift();
this.R=0}},pause:function(){!this.paused&&this.I&&(this.paused=!0,cancelAnimationFrame(this.S))},Za:function(){this.paused&&(this.paused=!1,this.R=performance.now(),this.S=requestAnimationFrame(this.step))},remove:function(a){for(var b=0;b<this.B.length;b++)if(this.B[b].ub==a){this.B.splice(b,1);break}},add:function(a,b,c,d,h){this.remove(a);var k={},f={},g;for(g in b)k[g]=a[g],f[g]=b[g]-a[g];this.B.length||(this.R=0);var l={ub:a,target:b,kb:h,o:f,Yb:k,Lb:c||500,Ab:d,vb:0,Ya:null};l.Xb=new Promise(function(a){l.Ya=
a}.bind(l));this.B.push(l);this.I||this.start();return l.Xb}};var m=window.Beziers={ib:n(0.42,0,0.58,1),Mb:n(0.42,0,1,1),Nb:n(0,0,0.58,1),ac:n(0.74,0,0.79,0.12),bc:n(0,1,0.87,0.94)};m.easeInOut=m.ib;m.easeIn=m.Mb;m.easeOut=m.Nb;c.g.Q=function(a){this.f=a;this.b=a.b;this.aa=this.b.e;this.X=this.U=this.wa=!1;this.fa=!("onmousewheel"in document.body);this.rb="ontouchstart"in window||"onpointerdown"in window;this.a={c:{Da:[0,0],q:null,O:null,I:null,jc:[0,0],gc:0,m:{start:["mousedown","touchstart"],move:["mousemove",
"touchmove"],stop:["mouseup","touchend"]},d:{Db:325,$a:null,timestamp:null,o:null,p:!1,scroll:[0,0],x:{offset:0,Z:0,r:0,frame:0,u:0,target:0,o:0},y:{offset:0,Z:0,r:0,frame:0,u:0,target:0,o:0}}},k:{q:null,O:null,yb:0,zb:0,hb:[0,0],ba:[0,0],Ca:[0,0],La:0,Wb:0},M:{q:null,O:null},hash:{Ua:!0,ka:!1,ra:["click","touchend"],A:null}};this.P()};c.g.Q.prototype={P:function(){this.Qa=this.Qa.bind(this);this.ia=this.ia.bind(this);this.oa=this.oa.bind(this);this.na=this.na.bind(this);this.Ka=this.Ka.bind(this);
this.da=this.da.bind(this);this.Ba=this.Ba.bind(this);this.Aa=this.Aa.bind(this);this.Xa=this.Xa.bind(this);this.ga=this.ga.bind(this);this.M=this.M.bind(this);this.ab=this.ab.bind(this);this.pa=this.pa.bind(this);this.xa=this.xa.bind(this);this.ea=this.ea.bind(this);this.ja=this.ja.bind(this)},stop:function(){cancelAnimationFrame(this.a.c.d.q);cancelAnimationFrame(this.a.c.q);cancelAnimationFrame(this.a.k.q);cancelAnimationFrame(this.a.M.q)},va:function(){if(!this.wa){this.wa=!0;for(var a in this.a.c.m.start)this.b.e.addEventListener(this.a.c.m.start[a],
this.oa);this.rb&&this.b.e.addEventListener("touchstart",this.Ba);this.b.e.addEventListener(this.fa?"DOMMouseScroll":"mousewheel",this.M);this.b.e.addEventListener("dblclick",this.pa);this.b.data.hookKeys&&document.addEventListener("keydown",this.xa);addEventListener("hashchange",this.ea);for(var b in this.a.hash.ra)document.documentElement.addEventListener(this.a.hash.ra[b],this.ja);this.b.e.classList.add("hooked")}},Ga:function(){if(this.wa){this.wa=!1;for(var a in this.a.c.m.start)this.b.e.removeEventListener(this.a.c.m.start[a],
this.oa);this.rb&&this.b.e.removeEventListener("touchstart",this.Ba);this.b.e.removeEventListener(this.fa?"DOMMouseScroll":"mousewheel",this.M);this.b.e.removeEventListener("dblclick",this.pa);this.b.data.hookKeys&&document.removeEventListener("keydown",this.xa);removeEventListener("hashchange",this.ea);for(var b in this.a.hash.ra)document.documentElement.removeEventListener(this.a.hash.ra[b],this.ja);this.b.e.classList.remove("hooked")}},Pa:function(a){if(a.touches.length)return a.touches[0]},oa:function(a){if(("mousedown"!=
a.type||1==a.which)&&this.f.G!=this.f.j){if(this.U)return a.touches&&2==a.touches.length&&this.da(a);this.U=!0;this.f.stop();for(var b in this.a.c.m.move)addEventListener(this.a.c.m.move[b],this.na);for(b in this.a.c.m.stop)addEventListener(this.a.c.m.stop[b],this.da);this.b.e.classList.add("dragging");a.touches&&(a=this.Pa(a));this.a.c.Da=[a.clientX,a.clientY];this.a.c.d.y.Z=a.clientY;this.a.c.d.y.r=this.a.c.d.y.u=0;this.a.c.d.y.frame=this.a.c.d.y.offset;this.a.c.d.x.Z=a.clientX;this.a.c.d.x.r=this.a.c.d.x.u=
0;this.a.c.d.x.frame=this.a.c.d.x.offset;this.a.c.d.timestamp=performance.now();clearInterval(this.a.c.d.$a);this.a.c.d.$a=setInterval(this.Qa,100)}},na:function(a){cancelAnimationFrame(this.a.c.q);a.stopPropagation();a.preventDefault();a.touches&&(a=this.Pa(a));this.a.c.O=a;this.a.c.q=requestAnimationFrame(this.Ka)},Ka:function(a){a=this.a.c.O;this.f.t(this.a.c.Da[0]-a.clientX,this.a.c.Da[1]-a.clientY);this.f.H();this.a.c.Da=[a.clientX,a.clientY];this.a.c.d.x.o=this.a.c.d.x.Z-a.clientX;if(2<this.a.c.d.x.o||
-2>this.a.c.d.x.o)this.a.c.d.x.Z=a.clientX,this.a.c.d.x.offset+=this.a.c.d.x.o;this.a.c.d.y.o=this.a.c.d.y.Z-a.clientY;if(2<this.a.c.d.y.o||-2>this.a.c.d.y.o)this.a.c.d.y.Z=a.clientY,this.a.c.d.y.offset+=this.a.c.d.y.o},da:function(a){if(this.U){this.U=!1;setTimeout(function(){}.bind(this));for(var b in this.a.c.m.move)removeEventListener(this.a.c.m.move[b],this.na);for(b in this.a.c.m.stop)removeEventListener(this.a.c.m.stop[b],this.da);this.b.e.classList.remove("dragging");a.touches&&(a=this.Pa(a));
clearInterval(this.a.c.d.$a);if(10<this.a.c.d.y.r||-10>this.a.c.d.y.r||10<this.a.c.d.x.r||-10>this.a.c.d.x.r)this.a.c.d.x.u=0.8*this.a.c.d.x.r,this.a.c.d.x.target=Math.round(this.a.c.d.x.offset+this.a.c.d.x.u),this.a.c.d.y.u=0.8*this.a.c.d.y.r,this.a.c.d.y.target=Math.round(this.a.c.d.y.offset+this.a.c.d.y.u),this.a.c.d.timestamp=performance.now(),this.a.c.d.q=requestAnimationFrame(this.ia)}},Qa:function(){this.a.c.d.o=1+(performance.now()-this.a.c.d.timestamp);this.a.c.d.timestamp=performance.now();
this.a.c.d.x.r=0.8*(1E3*(this.a.c.d.x.offset-this.a.c.d.x.frame)/this.a.c.d.o)+0.2*this.a.c.d.x.r;this.a.c.d.y.r=0.8*(1E3*(this.a.c.d.y.offset-this.a.c.d.y.frame)/this.a.c.d.o)+0.2*this.a.c.d.y.r;this.a.c.d.x.frame=this.a.c.d.x.offset;this.a.c.d.y.frame=this.a.c.d.y.offset},scroll:function(a,b){this.f.t(a-this.a.c.d.x.offset,b-this.a.c.d.y.offset);this.f.H();this.a.c.d.x.offset=a;this.a.c.d.y.offset=b},ia:function(){this.a.c.d.p=!1;this.a.c.d.scroll=[this.a.c.d.x.target,this.a.c.d.y.target];this.a.c.d.jb=
performance.now()-this.a.c.d.timestamp;if(this.a.c.d.x.u){var a=-this.a.c.d.x.u*Math.exp(-this.a.c.d.jb/this.a.c.d.Db);if(0.5<a||-0.5>a)this.a.c.d.scroll[0]=this.a.c.d.x.target+a,this.a.c.d.p=!0}this.a.c.d.y.u&&(a=-this.a.c.d.y.u*Math.exp(-this.a.c.d.jb/this.a.c.d.Db),0.5<a||-0.5>a)&&(this.a.c.d.scroll[1]=this.a.c.d.y.target+a,this.a.c.d.p=!0);this.scroll(this.a.c.d.scroll[0],this.a.c.d.scroll[1]);this.a.c.d.p&&(this.a.c.d.q=requestAnimationFrame(this.ia))},ob:function(a){if(2==a.touches.length)return Math.Ea(a.touches[0].clientX-
a.touches[1].clientX,a.touches[0].clientY-a.touches[1].clientY)/Math.Ea(this.aa.offsetWidth,this.aa.offsetHeight)},nb:function(a){this.a.k.ba[0]=Math.min(a.touches[0].clientX,a.touches[1].clientX);this.a.k.ba[1]=Math.min(a.touches[0].clientY,a.touches[1].clientY);this.a.k.Ca[0]=Math.max(a.touches[0].clientX,a.touches[1].clientX);this.a.k.Ca[1]=Math.max(a.touches[0].clientY,a.touches[1].clientY);return[this.a.k.ba[0]+(this.a.k.Ca[0]-this.a.k.ba[0])/2,this.a.k.ba[1]+(this.a.k.Ca[1]-this.a.k.ba[1])/
2]},Ba:function(a){if(this.X||2!=a.touches.length)return this.ga(a);a.stopPropagation();a.preventDefault();this.f.stop();this.X=!0;this.a.k.yb=this.ob(a);this.a.k.zb=this.f.j;this.a.k.hb=this.f.D(this.nb(a),!0);this.b.e.addEventListener("touchmove",this.Aa);this.b.e.addEventListener("touchend",this.ga);this.b.e.classList.add("pinching")},Aa:function(a){cancelAnimationFrame(this.a.k.q);a.stopPropagation();a.preventDefault();this.a.k.O=a;this.a.k.q=requestAnimationFrame(this.Xa)},Xa:function(a){a=this.a.k.O;
this.a.k.La=this.ob(a);if(this.a.k.La){this.f.K(this.a.k.zb*(this.a.k.Wb=this.a.k.La/this.a.k.yb));var b=this.f.ua(this.a.k.hb,!0);a=this.nb(a);this.f.t(b[0]-a[0],b[1]-a[1]);this.f.H()}},ga:function(){this.X&&(this.X=!1,this.b.e.removeEventListener("touchmove",this.Aa),this.b.e.removeEventListener("touchend",this.ga),this.b.e.classList.remove("pinching"))},M:function(a){this.U||this.X||0>(this.fa?30*-a.detail:a.wheelDelta)&&this.f.G==this.f.j||(a.preventDefault(),this.a.M.O=a,this.f.stop(),this.a.M.q=
requestAnimationFrame(this.ab))},ab:function(a){a=this.a.M.O;var b=!(this.f.n.T&&this.fa),c=this.f.D([a.clientX,a.clientY],b);this.f.zoom(this.fa?30*-a.detail:a.wheelDelta);b=this.f.ua(c,b);this.f.t(b[0]-a.clientX,b[1]-a.clientY);this.f.H()},pa:function(a){this.f.stop();1==this.f.j?!this.b.Jb||this.b.l&&this.b.l.tb&&this.b.l.C||this.f.Ma(0.5,0.5,this.f.G,1E3):(a=this.f.D([a.clientX,a.clientY],!0),this.f.Ma(a[0],a[1],2.5*this.f.j,400))},xa:function(a){if(!this.U&&!this.X){switch(a.keyCode){case 37:this.f.t(-this.aa.offsetWidth/
2,0);break;case 39:this.f.t(this.aa.offsetWidth/2,0);break;case 38:this.f.t(0,-this.aa.offsetHeight/2);break;case 40:this.f.t(0,this.aa.offsetHeight/2);break;case 32:this.f.zoom(a.shiftKey&&-120||120,!0);break;case 187:case 61:a.shiftKey&&this.f.zoom(120,!0);break;case 189:case 173:this.f.zoom(-120,!0);break;default:return}this.f.stop();this.f.H()}},ja:function(a){"A"==a.target.tagName&&(a.target.href&&!a.target.href.indexOf(location.href.replace(/#.*/,"#")))&&(this.a.hash.ka=!0)},ea:function(a){if(this.a.hash.ka||
this.a.hash.Ua)this.a.hash.A=location.hash.substr(1).split(","),3!=this.a.hash.A.length||(isNaN(this.a.hash.A[0])||isNaN(this.a.hash.A[1])||isNaN(this.a.hash.A[2]))||(this.a.hash.Ib=this.a.hash.A,this.f.stop(),a&&a.preventDefault(),this.a.hash.Ua?(this.f.K(this.a.hash.A[2],!0),this.f.$(this.a.hash.A)):this.f.sa(this.a.hash.A[0],this.a.hash.A[1],this.a.hash.A[2])),this.a.hash.Ua=!1,this.a.hash.ka=!1}};c.g.Q.prototype.hook=c.g.Q.prototype.va;c.g.Q.prototype.unhook=c.g.Q.prototype.Ga})();

// MS PointerEvents
/*! Copyright (c) Andrea Giammarchi - MIT License */
(function(d,f,l){function v(a){this._=a;this.currentTarget=a.currentTarget}if(!(!(l=!!d.pointerEnabled)&&!d.msPointerEnabled||"ontouchend"in f)){var w=l?"setPointerCapture":"msSetPointerCapture",x=l?"releasePointerCapture":"msReleasePointerCapture";d=Element.prototype;var m=Object.defineProperties,y=Object.defineProperty,n=function(a){var b=a.toLowerCase();a="MS"+a;t[a]=t[b];return l?b:a},g=function(a){return{value:function(){C[a].call(this);this._[a]()}}},p=function(a){var b="_on"+a;return{enumerable:!0,
configurable:!0,get:function(){return this[b]||null},set:function(e){this[b]&&this.removeEventListener(a,this[b]);(this[b]=e)&&this.addEventListener(a,e)}}},q=function(a,b){var e=a[b];y(a,b,{configurable:!0,value:function(a,b,c){a in h&&e.call(this,h[a],D,c);e.call(this,a,b,c)}})},c=function(a){return{get:function(){return this._[a]}}},z=function(a){return function(b){var e=b.pointerId,c=k[e],d=b.currentTarget;delete k[e];if(x in d)d[x](b.pointerId);u(a,b,c);delete r[e]}},u=function(a,b,e){var c=
f.createEvent("Event");c.initEvent(a,!0,!0);s.value=b;A.currentTarget.value=e&&e.currentTarget;m(c,A);e&&e.currentTarget.dispatchEvent(c)},B=function(a,b){function c(a){return b[a]}return function(){s.value=Object.keys(b).map(c);return y(this,a,s)[a]}},s={value:null},k=Object.create(null),r=Object.create(null),C=f.createEvent("Event"),A={_:s,touches:{configurable:!0,get:B("touches",k)},changedTouches:{configurable:!0,get:B("changedTouches",r)},currentTarget:{value:null},relatedTarget:c("relatedTarget"),
target:c("target"),altKey:c("altKey"),metaKey:c("metaKey"),ctrlKey:c("ctrlKey"),shiftKey:c("shiftKey"),preventDefault:g("preventDefault"),stopPropagation:g("stopPropagation"),stopImmediatePropagation:g("stopImmediatePropagation")},h=Object.create(null),D=function(a){var b;a:{switch(a.pointerType){case "mouse":case a.MSPOINTER_TYPE_MOUSE:b="mouse";break a}b="touch"}if("touch"===b)t[a.type](a)},t={pointerdown:function(a){var b=new v(a),c=a.pointerId,d=a.currentTarget;r[c]=k[c]=b;if(w in d)d[w](a.pointerId);
u("touchstart",a,b)},'pointermove':function(a){var b=a.pointerId,c=k[b];c._=a;u("touchmove",a,c);r[b]._=a},'pointerup':z("touchend"),'pointercancel':z("touchcancel")},g={'ontouchstart':p("touchstart"),'ontouchmove':p("touchmove"),'ontouchend':p("touchend"),'ontouchcancel':p("touchcancel")};m(v.prototype,{identifier:c("pointerId"),target:c("target"),screenX:c("screenX"),screenY:c("screenY"),clientX:c("clientX"),clientY:c("clientY"),pageX:c("pageX"),pageY:c("pageY")});h['touchstart']=n("PointerDown");h['touchmove']=n("PointerMove");
h['touchend']=n("PointerUp");h['touchcancel']=n("PointerCancel");q(f,"addEventListener");q(f,"removeEventListener");q(d,"addEventListener");q(d,"removeEventListener");m(f,g);m(d,g)}})(navigator,document);

/*! promise-polyfill 2.0.1 */
!function(a){function b(a,b){return function(){a.apply(b,arguments)}}function c(a){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],i(a,b(e,this),b(f,this))}function d(a){var b=this;return null===this._state?void this._deferreds.push(a):void j(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c)return void(b._state?a.resolve:a.reject)(b._value);var d;try{d=c(b._value)}catch(e){return void a.reject(e)}a.resolve(d)})}function e(a){try{if(a===this)throw new TypeError("A promise cannot be resolved with itself.");if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void i(b(c,a),b(e,this),b(f,this))}this._state=!0,this._value=a,g.call(this)}catch(d){f.call(this,d)}}function f(a){this._state=!1,this._value=a,g.call(this)}function g(){for(var a=0,b=this._deferreds.length;b>a;a++)d.call(this,this._deferreds[a]);this._deferreds=null}function h(a,b,c,d){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.resolve=c,this.reject=d}function i(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){if(d)return;d=!0,c(e)}}var j=c.immediateFn||"function"==typeof setImmediate&&setImmediate||function(a){setTimeout(a,1)},k=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};c.prototype["catch"]=function(a){return this.then(null,a)},c.prototype.then=function(a,b){var e=this;return new c(function(c,f){d.call(e,new h(a,b,c,f))})},c.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&k(arguments[0])?arguments[0]:arguments);return new c(function(b,c){function d(f,g){try{if(g&&("object"==typeof g||"function"==typeof g)){var h=g.then;if("function"==typeof h)return void h.call(g,function(a){d(f,a)},c)}a[f]=g,0===--e&&b(a)}catch(i){c(i)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})},c.resolve=function(a){return a&&"object"==typeof a&&a.constructor===c?a:new c(function(b){b(a)})},c.reject=function(a){return new c(function(b,c){c(a)})},c.race=function(a){return new c(function(b,c){for(var d=0,e=a.length;e>d;d++)a[d].then(b,c)})},"undefined"!=typeof module&&module.exports?module.exports=c:a.Promise||(a.Promise=c)}(this);
