/* Micrio.min.js, R741f60ce56f99085e9578ce136df6edecbf3665c/1439497173+
 * Copyright (C) Q42 Internet B.V. - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * Written by Marcel Duin <marcel@q42.nl>, 2015
 */
(function(){function c(a){this.data=a;this.id=a.id;this.width=a.width;this.height=a.height;this.path=a.path||"";this.I=a.tileSize||a.zoomify&&256||512;this.Pb=!1!==a.hookEvents;this.Pa="cover"==a.initType;this.Eb=!1!==a.autoInit;this.F=a.json||{};this.Z=!a.noLevel0&&1||0;this.Yb=a.zoomify;this.ya=navigator.h.ie9||navigator.h.iOS&&navigator.h.mobile;this.Va=navigator.h.ie||navigator.h.firefox||navigator.h.safari;this.Gb=this.ya&&1||1;this.aspect=this.width/this.height;for(var b=this.I;b<Math.max(this.width,
this.height);b*=2,this.Z++);this.ratio=this.U=window.devicePixelRatioIEMobile||!this.ya&&!a.noRetina&&window.devicePixelRatio&&Math.min(2,window.devicePixelRatio)||1;this.el=this.i=a.canvas instanceof Element&&a.canvas||document.getElementById(this.id)||document.createElement("canvas");this.i.classList.add("micrio");this.i.offset={top:0,left:0};this.container=this.e=a.container||this.i.parentNode||document.body;this.e.classList.add("micrio-container");this.la=this.i.getContext("2d");this.i.parentNode&&
this.e==this.i.parentNode||this.e.appendChild(this.i);this.camera=this.f=new c.g(this);c.Bb&&(this.audio=this.cb=new c.Bb(this));c.Cb&&this.F.pointsOfInterest&&(this.pointsOfInterest=this.l=new c.Cb(this));this.O=[];this.xa=this.B=this.Qa=!1;this.Eb&&this.N()}function p(a){var b="",e;for(e in s)b+=a.replace(/\$/,s[e]);return b}function m(a,b,e,c){var g=3*a,d=3*(e-a)-g,f=1-g-d,h=3*b,k=3*(c-b)-h,w=1-h-k;return function(a){for(var b=a,e=0,c;2>e;){c=b*(g+b*(d+b*f))-a;if(0.0010>Math.abs(c))break;b-=c/
(g+b*(2*d+3*f*b));e++}a=b;return a*(h+a*(k+a*w))}}(function(){for(var a=0,b=["ms","moz","webkit","o"],e=0;e<b.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[b[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[e]+"CancelAnimationFrame"]||window[b[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var e=(new Date).getTime(),c=Math.max(0,16-(e-a)),f=window.setTimeout(function(){b(e+c)},c);a=e+c;return f});
window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})})();window.performance||(window.performance={});window.performance.now||(window.performance.now=Date.now);if("undefined"!==typeof window.Element&&!("classList"in document.documentElement)){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var e=b||0,c=this.length;e<c;e++)if(this[e]===a)return e;return-1});var d=Array.prototype,t=d.indexOf,u=d.slice,v=d.push,x=d.splice,y=d.join,q=function(a){this.bb=
a;if("string"==typeof a.className&&a.className!=this.Ga&&(this.Ga=a.className)){a=this.Ga.replace(/^\s+|\s+$/g,"").split(/\s+/);var b;for(b=0;b<a.length;b++)v.call(this,a[b])}};q.prototype={add:function(a){this.contains(a)||(v.call(this,a),a=u.call(this,0),this.bb.className=a.join(" "))},contains:function(a){return-1!==t.call(this,a)},remove:function(a){a=t.call(this,a);-1!==a&&(x.call(this,a,1),a=u.call(this,0),this.bb.className=a.join(" "))},toString:function(){return y.call(this," ")}};window.DOMTokenList=
q;(function(a,b,e){Object.defineProperty?Object.defineProperty(a,b,{get:e}):a.__defineGetter__(b,e)})(window.Element.prototype,"classList",function(){return new q(this)})}if(navigator.userAgent&&(d=navigator.userAgent.toLowerCase(),/msie/.test(d)||/rv\:11\.0/.test(d)||!window.Zb)){var n=function(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");e.initCustomEvent(a,b.bubbles,b.cancelable,b.detail);return e};n.prototype=window.CustomEvent&&window.CustomEvent.prototype||
window.Event.prototype;window.CustomEvent=n}Math.Da=function(a,b){return Math.sqrt(a*a+b*b)};d=navigator.userAgent.toLowerCase();navigator.h={};navigator.h.webkit=/applewebkit/.test(d);navigator.h.firefox=/firefox/.test(d);navigator.h.safari=/safari/.test(d)&&!/chrome/.test(d);navigator.h.ie=/msie/.test(d)||/trident/.test(d)||/edge\//.test(d);navigator.h.iemobile=/iemobile/.test(d);navigator.h.iOS=/ipad|iphone|ipod/.test(d);navigator.h.android=/android/.test(d);navigator.h.ie9=navigator.h.ie&&/ie 9/.test(d);
navigator.h.iPad=/ipad/.test(d);navigator.h.mobile=navigator.h.iOS||navigator.h.android||navigator.h.iemobile;navigator.h.unknown=!navigator.h.webkit&&!navigator.h.firefox&&!navigator.h.ie&&!navigator.h.iOS&&!navigator.h.android;d={};d.transform="webkitTransform"in document.documentElement.style?"webkitTransform":"mozTransform"in document.documentElement.style?"mozTransform":"msTransform"in document.documentElement.style?"msTransform":"transform";d.translate3d=navigator.h.ie9?["translate(",")"]:["translate3d(",
",0)"];d.scale3d=navigator.h.ie9?["scale(",")"]:["scale3d(",",1)"];window.CSS=d;navigator.browser=navigator.h;navigator.h.iemobile&&(window.ac=Math.round(window.screen.availWidth/document.documentElement.clientWidth));c.prototype={N:function(){if(!this.Qa){this.Qa=!0;for(var a=0;a<this.Z;a++)this.O.push(new c.aa(this,a));for(a=this.Z-1;0<=a;a--)this.O[a].yb=a<this.Z-1&&this.O[a+1].yb+this.O[a+1].Qb||0;this.f.N();this.l&&this.l.N();return this.show()}},show:function(){if(!this.Qa)return this.N();if(this.B)return new Promise(function(a,
b){b&&b("Already shown")});this.B=!0;this.e.appendChild(this.i);this.f.start();this.cb&&this.cb.N();this.l&&this.l.fc();this.f.ua();return this.Db=new Promise(function(a,b){this.xa?a.bind(this)():(this.i.addEventListener("loaded",a.bind(this)),b&&this.i.addEventListener("error",b.bind(this)))}.bind(this))},Ob:function(){this.B&&(this.B=!1,this.e.removeChild(this.i),this.l&&this.l.remove(),this.f.stop(),this.f.Fa())},K:function(){for(var a=!1,b=!1,e=[],c=[],g=this.U,d=this.O.filter(function(a){return a.a.scale>=
0.6/g}),f=0,h,k;f<d.length;f++)if(h=d[f].nb(),k=h.filter(function(a){return a&&a.loaded}),e=e.concat(k),c=c.concat(h.filter(function(a){return a&&!a.src})),k.filter(function(a){return 1==a.opacity}).length==h.length){a=0==f;break}this.Va&&d[f+1]&&(e=e.concat(d[f+1].nb().filter(function(a){return a&&a.loaded})));e.reverse();c.reverse();for(f=0;f<e.length;f++)e[f].K(),1>e[f].opacity&&(b=!0);for(f=0;f<this.Gb&&f<c.length;f++)c[f].load();!a||b?this.f.D():this.xa||(this.xa=!0,this.i.dispatchEvent(new n("loaded",
{detail:this.b})))}};window.Micrio=c;c.prototype.show=c.prototype.show;c.prototype.hide=c.prototype.Ob;c.aa=function(a,b){this.b=a;this.Ua=b;this.F=this.b.F&&this.b.F.levels&&this.b.F.levels[b];this.scale=Math.pow(2,b);this.zb=[];this.Ra=[];this.a={scale:1,v:[0,0,0,0]};this.I=a.I*this.scale;this.pa=[Math.ceil(a.width/this.I),Math.ceil(a.height/this.I)];this.Qb=this.pa[0]*this.pa[1];this.Ea=[this.I/this.b.width,this.I/this.b.height]};c.aa.prototype={nb:function(){this.Ra=[];var a=this.b.f.Ia;this.a.v[0]=
Math.floor(a[0][0]/this.Ea[0]);this.a.v[1]=Math.ceil(a[1][0]/this.Ea[0]);this.a.v[2]=Math.floor(a[0][1]/this.Ea[1]);this.a.v[3]=Math.floor(a[1][1]/this.Ea[1]);for(var b=a=0;this.a.v[2]-1<this.a.v[3];this.a.v[2]++)for(b=this.a.v[0],a=this.pa[0]*this.a.v[2];b<this.a.v[1];b++)this.Ra.push(this.zb[a+b]||(this.zb[a+b]=new c.aa.ab(this,b,this.a.v[2],this.F&&this.F.tiles[a+b])));return this.Ra}};c.aa.ab=function(a,b,e,c){this.r=a;this.x=b;this.y=e;this.F=c;this.loaded=!1;this.tb=0;this.opacity=(a.b.ya||
!a.b.xa)&&1||0;this.height=this.width=0;this.Ub=b*this.r.b.I;this.Vb=e*this.r.b.I;this.S=new Image;this.S.onload=this.onload.bind(this)};c.aa.ab.prototype={load:function(){var a=this.r.b,b=this.r,e=this.F,c=this.x,d=this.y;this.src=this.S.src=e&&e.url||a.path+a.id+"/"+(a.data.isMontBlanc?a.Z-b.Ua+7+"/"+c+"_"+d+".jpeg":a.Yb?"TileGroup"+Math.floor((b.yb+d*b.pa[0]+c)/256)+"/"+(a.Z-b.Ua-1)+"-"+c+"-"+d+".jpg":b.Ua+"/"+c+"-"+d+".jpg")},onload:function(){this.width=this.S.naturalWidth||this.S.height;this.height=
this.S.naturalHeight||this.S.width;this.loaded=!0;this.tb=performance.now()},K:function(a,b){this.loaded&&(a=a||this.r.b.f.k*this.r.scale,b=b||this.r.b.f.offset,this.r.b.ya||(1>this.opacity&&(this.opacity=Math.min(1,(performance.now()-this.tb)/250)),this.r.b.la.globalAlpha=this.opacity),this.r.b.la.drawImage(this.S,this.Ub*a-b[0],this.Vb*a-b[1],this.r.b.Va&&Math.ceil(this.width*a)||this.width*a,this.r.b.Va&&Math.ceil(this.height*a)||this.height*a))}};var d=document.createElement("style"),s=["-webkit-",
"-moz-","-ms-",""];d.textContent=".micrio-container{"+p("$user-select:none;")+"-ms-content-zooming:none;-ms-touch-action:none;touch-action:none;}.micrio-container.hooked{cursor:move;"+p("cursor:$grab;")+"}.micrio-container.dragging{"+p("cursor:$grabbing;")+"}.micrio-container.fullscreen{width:100%;height:100%;}";document.head.appendChild(d);c.g=function(a){this.b=a;this.offset=[0,0];this.position={x:0,y:0,z:0};this.P=Math.min(this.b.e.offsetWidth/this.b.width,this.b.e.offsetHeight/this.b.height);
this.ka=Math.max(this.b.e.offsetWidth/this.b.width,this.b.e.offsetHeight/this.b.height);this.pb=this.k=a.Pa?this.ka:this.P;this.ja=this.T=this.R=!1;this.Ia=null;this.w=[0,0,0];this.ub="";this.Ha={left:0,top:0}};c.g.prototype={N:function(){c.g.Q&&(this.events=this.m=new c.g.Q(this));this.u=new c.g.$a;this.K=this.K.bind(this);this.sa=this.sa.bind(this);this.hb();this.onresize=this.onresize.bind(this);this.onresize()},start:function(){this.m&&(this.m.ea(),this.m.a.hash.Fb||(this.G(this.k),this.b.Pa?
this.W([0.5,0.5]):this.s(0,0)));this.onresize()},stop:function(){this.u.stop();this.m&&this.m.stop()},ua:function(){this.m&&this.b.Pb&&this.m.ua();addEventListener("resize",this.onresize)},Fa:function(){this.m&&this.m.Fa();removeEventListener("resize",this.onresize);document.removeEventListener(this.n.onchange,this.sa)},ra:function(a,b,e,c,d){this.stop();var l=this.C([this.b.e.offsetWidth/2,this.b.e.offsetHeight/2]),f=0,h=0,k=l[0],m=l[1],n=this.k,p=e>n;c=void 0!==c?c:1E4*Math.Da(this.w[2]-e,Math.Da(this.w[0]-
a,this.w[1]-b))*(1/d);return this.u.add(this.position,{},c,function(c){f=r.Ib(c);h=(p&&r.Wb||r.Xb)(c);this.position.x=k*(1-f)+a*f;this.position.y=m*(1-f)+b*f;this.position.z=n*(1-h)+e*h;this.G(this.position.z);this.W([this.position.x,this.position.y],!0,!0);this.D()}.bind(this))},Kb:function(a){a=this.k==this.P?0:a||1E3;return this.b.f.ra(0.5,0.5,this.b.f.P,a)},Jb:function(a){a=this.k==this.P?0:a||1E3;return this.b.f.ra(0.5,0.5,this.b.f.ka,a)},La:function(a,b,c,d,g){this.stop();var l=this.C([this.b.e.offsetWidth/
2,this.b.e.offsetHeight/2]),f={};void 0!==a&&(f.x=a);void 0!==b&&(f.y=b);void 0!==c&&(f.z=Math.min(g&&Infinity||1,Math.max(0,c)));this.position.x=l[0];this.position.y=l[1];this.position.z=this.k;return this.u.add(this.position,f,d||5E3,function(){this.G(this.position.z,g);this.W([this.position.x,this.position.y],!0);this.D()}.bind(this))},reset:function(){this.G(this.pb);this.W([0.5,0.5])},C:function(a,b,c){c?(this.Ha=this.lb(),a[0]-=this.Ha.left-(window.scrollX||window.pageXOffset),a[1]-=this.Ha.top-
(window.scrollY||window.pageYOffset)):b&&(a[0]-=this.b.i.offset.left-(window.scrollX||window.pageXOffset),a[1]-=this.b.i.offset.top-(window.scrollY||window.pageYOffset));return[Math.max(0,Math.min(this.b.width,(this.offset[0]+a[0])/this.k)/this.b.width),Math.max(0,Math.min(this.b.height,(this.offset[1]+a[1])/this.k)/this.b.height),this.k]},W:function(a,b,c){this.b.l&&(this.b.l.qb&&this.b.l.B&&!this.b.f.u.H&&(c=!0))&&(a=this.b.l.B.ec(a));this.s((this.position.x=a[0])*this.b.width*this.k-this.b.e.offsetWidth/
2,(this.position.y=a[1])*this.b.height*this.k-this.b.e.offsetHeight/2,!0,c,this.b.l&&this.b.l.B);b||this.D();return!0},Mb:function(){return this.w},ta:function(a,b){return[a[0]*this.b.width*this.k-this.offset[0]+(b&&this.b.i.offset.left-(window.scrollX||window.pageXOffset)||0),a[1]*this.b.height*this.k-this.offset[1]+(b&&this.b.i.offset.top-(window.scrollY||window.pageYOffset)||0)]},mb:function(){return[this.C([0,0]),this.C([this.b.e.offsetWidth,this.b.e.offsetHeight])]},s:function(a,b,c,d,g){if(!g&&
this.b.l&&this.b.l.qb&&this.b.l.B&&!this.b.f.u.H)return this.W(this.C([this.b.e.offsetWidth/2+(c?0:a),this.b.e.offsetHeight/2+(c?0:b)]),!1,d);d?(this.offset[0]=a+(c?0:this.offset[0]),this.offset[1]=b+(c?0:this.offset[1])):(d=this.b.width*this.k-this.b.e.offsetWidth,g=this.b.height*this.k-this.b.e.offsetHeight,this.offset[0]=Math.max(0,Math.min(d,a+(c?0:this.offset[0])))+(0>d&&d/2||0),this.offset[1]=Math.max(0,Math.min(g,b+(c?0:this.offset[1])))+(0>g&&g/2||0));this.Ia=this.mb();return!0},G:function(a,
b){if(this.b.l&&this.b.l.B&&!this.b.f.u.H&&a<this.b.l.B.$b)return!1;this.k=Math.max(this.P,Math.min(b&&Infinity||1,a));for(var c=0;c<this.b.O.length;c++)this.b.O[c].a.scale=this.k*this.b.O[c].scale;return!0},K:function(){this.Ia=this.mb();this.w=this.C([this.b.e.offsetWidth/2,this.b.e.offsetHeight/2]);this.b.la.clearRect(0,0,this.b.i.width,this.b.i.height);this.b.K();this.w.join(",")!=this.ub&&(this.b.l&&this.b.l.draw(),this.b.i.dispatchEvent(new n("move",{detail:this.w})));this.ub=this.w.join(",")},
D:function(){cancelAnimationFrame(this.ba);this.ba=requestAnimationFrame(this.K)},zoom:function(a,b){var c=this.b.e.offsetWidth/this.b.width,d=0.5*this.k/c,g=this.C([this.b.e.offsetWidth/2,this.b.e.offsetHeight/2]);b&&(g=this.ta(g),this.s(g[0]-this.b.e.offsetWidth/2,g[1]-this.b.e.offsetHeight/2));return this.G(this.k+c/3*d*(a/120))},lb:function(a){var b={top:0,left:0};a=a||this.b.i;do b.top+=a.offsetTop||0,b.left+=a.offsetLeft||0,a=a.offsetParent;while(a&&(!this.n||!this.n.ca));return b},onresize:function(){this.b.i.width=
this.b.e.offsetWidth*this.b.U;this.b.i.height=this.b.e.offsetHeight*this.b.U;1!=this.b.U&&(this.b.i.style.width=this.b.e.offsetWidth+"px",this.b.i.style.height=this.b.e.offsetHeight+"px");this.b.i.offset=this.lb();this.P=Math.min(this.b.e.offsetWidth/this.b.width,this.b.e.offsetHeight/this.b.height);this.ka=Math.max(this.b.e.offsetWidth/this.b.width,this.b.e.offsetHeight/this.b.height);this.pb=this.b.Pa?this.ka:this.P;this.G(this.k);this.s(this.offset[0],this.offset[1],!0);1<this.b.U&&this.b.la.setTransform(this.b.U,
0,0,this.b.U,0,0);this.D()},hb:function(){this.ib||(this.ib=!0,this.n={ca:!1,ga:this.b.e.requestFullScreen||this.b.e.webkitRequestFullScreen||this.b.e.mozRequestFullScreen||this.b.e.msRequestFullscreen,Ma:document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen,onchange:"onwebkitfullscreenchange"in document?"webkitfullscreenchange":"onmozfullscreenchange"in document?"mozfullscreenchange":"onmsfullscreenchange"in document?"MSFullscreenChange":
"onfullscreenchange"in document?"fullscreenchange":null},this.n.ga?(this.n.ga=this.n.ga.bind(this.b.e),this.n.Ma=this.n.Ma.bind(document),document.addEventListener(this.n.onchange,this.sa)):this.b.e.classList.add("no-fullscreen"))},sa:function(){this.n.ca=(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)==this.b.e;this.b.e.classList[this.n.ca&&"add"||"remove"]("fullscreen");if(this.n.ca)this.onresize()},Lb:function(){this.ib||
this.hb();if(!this.n.ga)return console.warn("Your browser does not support full screen");this.n.ca?this.n.Ma():this.n.ga()},Nb:function(){return this.w[0].toPrecision(4)+","+this.w[1].toPrecision(4)+","+this.w[2].toPrecision(4)}};c.g.prototype.getXY=c.g.prototype.ta;c.g.prototype.getCurrentCoo=c.g.prototype.Mb;c.g.prototype.flyTo=c.g.prototype.ra;c.g.prototype.flyToFullView=c.g.prototype.Kb;c.g.prototype.flyToCoverView=c.g.prototype.Jb;c.g.prototype.easeTo=c.g.prototype.La;c.g.prototype.setCoo=c.g.prototype.W;
c.g.prototype.reset=c.g.prototype.reset;c.g.prototype.setScale=c.g.prototype.G;c.g.prototype.draw=c.g.prototype.K;c.g.prototype.onresize=c.g.prototype.onresize;c.g.prototype.fullScreenToggle=c.g.prototype.Lb;c.g.prototype.getHash=c.g.prototype.Nb;c.g.$a=function(){this.H=!1;this.A=[];this.step=this.step.bind(this);this.ba=null;this.X=0};c.g.$a.prototype={step:function(a){this.X||(this.X=a);for(var b,c,d,g=0;g<this.A.length;g++){c=this.A[g];d=Math.min(1,(c.sb+=a-this.X)/c.Hb);c.gb&&(d=c.gb(d));for(b in c.target)c.rb[b]=
c.Tb[b]*(1-d)+c.target[b]*d;1<=d&&(c.Xa&&c.Xa(c),this.A.splice(g--,1));c.xb&&c.xb(d)}this.X=a;this.A.length?this.ba=requestAnimationFrame(this.step):this.stop()},start:function(){this.H||(this.H=!0,this.ba=requestAnimationFrame(this.step))},stop:function(){if(this.H){this.H=!1;for(cancelAnimationFrame(this.ba);this.A.length;)this.A.shift();this.X=0}},remove:function(a){for(var b=0;b<this.A.length;b++)if(this.A[b].rb==a){this.A.splice(b,1);break}},add:function(a,b,c,d,g){this.remove(a);var l={},f=
{},h;for(h in b)l[h]=a[h],f[h]=b[h]-a[h];this.A.length||(this.X=0);var k={rb:a,target:b,gb:g,o:f,Tb:l,Hb:c||500,xb:d,sb:0,Xa:null};k.Sb=new Promise(function(a){k.Xa=a}.bind(k));this.A.push(k);this.H||this.start();return k.Sb}};var r={Ib:m(0.42,0,0.58,1),bc:m(0.42,0,1,1),cc:m(0,0,0.58,1),Wb:m(0.74,0,0.79,0.12),Xb:m(0,1,0.87,0.94)};c.g.Q=function(a){this.f=a;this.b=a.b;this.Y=this.b.e;this.T=this.R=this.va=!1;this.Sa=!("onmousewheel"in document.body);this.ob="ontouchstart"in window||"onpointerdown"in
window;this.a={c:{Ca:[0,0],p:null,L:null,H:null,gc:[0,0],dc:0,m:{start:["mousedown","touchstart"],move:["mousemove","touchmove"],stop:["mouseup","touchend"]},d:{Ab:325,Ya:null,timestamp:null,o:null,u:!1,scroll:[0,0],x:{offset:0,V:0,q:0,frame:0,t:0,target:0,o:0},y:{offset:0,V:0,q:0,frame:0,t:0,target:0,o:0}}},j:{p:null,L:null,vb:0,wb:0,eb:[0,0],$:[0,0],Ba:[0,0],Ka:0,Rb:0},J:{p:null,L:null},hash:{Ta:!0,ja:!1,qa:["click","touchend"],M:null}};this.N()};c.g.Q.prototype={N:function(){this.Oa=this.Oa.bind(this);
this.ha=this.ha.bind(this);this.na=this.na.bind(this);this.ma=this.ma.bind(this);this.Ja=this.Ja.bind(this);this.da=this.da.bind(this);this.Aa=this.Aa.bind(this);this.za=this.za.bind(this);this.Wa=this.Wa.bind(this);this.fa=this.fa.bind(this);this.J=this.J.bind(this);this.Za=this.Za.bind(this);this.oa=this.oa.bind(this);this.wa=this.wa.bind(this);this.ea=this.ea.bind(this);this.ia=this.ia.bind(this)},stop:function(){cancelAnimationFrame(this.a.c.d.p);cancelAnimationFrame(this.a.c.p);cancelAnimationFrame(this.a.j.p);
cancelAnimationFrame(this.a.J.p)},ua:function(){if(!this.va){this.va=!0;for(var a in this.a.c.m.start)this.b.e.addEventListener(this.a.c.m.start[a],this.na);this.ob&&this.b.e.addEventListener("touchstart",this.Aa);this.b.e.addEventListener(this.Sa?"DOMMouseScroll":"mousewheel",this.J);this.b.e.addEventListener("dblclick",this.oa);this.b.data.hookKeys&&document.addEventListener("keydown",this.wa);addEventListener("hashchange",this.ea);for(var b in this.a.hash.qa)document.documentElement.addEventListener(this.a.hash.qa[b],
this.ia);this.b.e.classList.add("hooked")}},Fa:function(){if(this.va){this.va=!1;for(var a in this.a.c.m.start)this.b.e.removeEventListener(this.a.c.m.start[a],this.na);this.ob&&this.b.e.removeEventListener("touchstart",this.Aa);this.b.e.removeEventListener(this.Sa?"DOMMouseScroll":"mousewheel",this.J);this.b.e.removeEventListener("dblclick",this.oa);this.b.data.hookKeys&&document.removeEventListener("keydown",this.wa);removeEventListener("hashchange",this.ea);for(var b in this.a.hash.qa)document.documentElement.removeEventListener(this.a.hash.qa[b],
this.ia);this.b.e.classList.remove("hooked")}},Na:function(a){if(a.touches.length)return a.touches[0]},na:function(a){if("mousedown"!=a.type||1==a.which){if(this.R)return a.touches&&2==a.touches.length&&this.da(a);this.R=!0;this.f.stop();for(var b in this.a.c.m.move)addEventListener(this.a.c.m.move[b],this.ma);for(b in this.a.c.m.stop)addEventListener(this.a.c.m.stop[b],this.da);this.b.e.classList.add("dragging");a.touches&&(a=this.Na(a));this.a.c.Ca=[a.clientX,a.clientY];this.a.c.d.y.V=a.clientY;
this.a.c.d.y.q=this.a.c.d.y.t=0;this.a.c.d.y.frame=this.a.c.d.y.offset;this.a.c.d.x.V=a.clientX;this.a.c.d.x.q=this.a.c.d.x.t=0;this.a.c.d.x.frame=this.a.c.d.x.offset;this.a.c.d.timestamp=performance.now();clearInterval(this.a.c.d.Ya);this.a.c.d.Ya=setInterval(this.Oa,100)}},ma:function(a){cancelAnimationFrame(this.a.c.p);a.stopPropagation();a.preventDefault();a.touches&&(a=this.Na(a));this.a.c.L=a;this.a.c.p=requestAnimationFrame(this.Ja)},Ja:function(a){a=this.a.c.L;this.f.s(this.a.c.Ca[0]-a.clientX,
this.a.c.Ca[1]-a.clientY);this.f.D();this.a.c.Ca=[a.clientX,a.clientY];this.a.c.d.x.o=this.a.c.d.x.V-a.clientX;if(2<this.a.c.d.x.o||-2>this.a.c.d.x.o)this.a.c.d.x.V=a.clientX,this.a.c.d.x.offset+=this.a.c.d.x.o;this.a.c.d.y.o=this.a.c.d.y.V-a.clientY;if(2<this.a.c.d.y.o||-2>this.a.c.d.y.o)this.a.c.d.y.V=a.clientY,this.a.c.d.y.offset+=this.a.c.d.y.o},da:function(a){if(this.R){this.R=!1;setTimeout(function(){}.bind(this));for(var b in this.a.c.m.move)removeEventListener(this.a.c.m.move[b],this.ma);
for(b in this.a.c.m.stop)removeEventListener(this.a.c.m.stop[b],this.da);this.b.e.classList.remove("dragging");a.touches&&(a=this.Na(a));clearInterval(this.a.c.d.Ya);if(10<this.a.c.d.y.q||-10>this.a.c.d.y.q||10<this.a.c.d.x.q||-10>this.a.c.d.x.q)this.a.c.d.x.t=0.8*this.a.c.d.x.q,this.a.c.d.x.target=Math.round(this.a.c.d.x.offset+this.a.c.d.x.t),this.a.c.d.y.t=0.8*this.a.c.d.y.q,this.a.c.d.y.target=Math.round(this.a.c.d.y.offset+this.a.c.d.y.t),this.a.c.d.timestamp=performance.now(),this.a.c.d.p=requestAnimationFrame(this.ha)}},
Oa:function(){this.a.c.d.o=1+(performance.now()-this.a.c.d.timestamp);this.a.c.d.timestamp=performance.now();this.a.c.d.x.q=0.8*(1E3*(this.a.c.d.x.offset-this.a.c.d.x.frame)/this.a.c.d.o)+0.2*this.a.c.d.x.q;this.a.c.d.y.q=0.8*(1E3*(this.a.c.d.y.offset-this.a.c.d.y.frame)/this.a.c.d.o)+0.2*this.a.c.d.y.q;this.a.c.d.x.frame=this.a.c.d.x.offset;this.a.c.d.y.frame=this.a.c.d.y.offset},scroll:function(a,b){this.f.s(a-this.a.c.d.x.offset,b-this.a.c.d.y.offset);this.f.D();this.a.c.d.x.offset=a;this.a.c.d.y.offset=
b},ha:function(){this.a.c.d.u=!1;this.a.c.d.scroll=[this.a.c.d.x.target,this.a.c.d.y.target];this.a.c.d.fb=performance.now()-this.a.c.d.timestamp;if(this.a.c.d.x.t){var a=-this.a.c.d.x.t*Math.exp(-this.a.c.d.fb/this.a.c.d.Ab);if(0.5<a||-0.5>a)this.a.c.d.scroll[0]=this.a.c.d.x.target+a,this.a.c.d.u=!0}this.a.c.d.y.t&&(a=-this.a.c.d.y.t*Math.exp(-this.a.c.d.fb/this.a.c.d.Ab),0.5<a||-0.5>a)&&(this.a.c.d.scroll[1]=this.a.c.d.y.target+a,this.a.c.d.u=!0);this.scroll(this.a.c.d.scroll[0],this.a.c.d.scroll[1]);
this.a.c.d.u&&(this.a.c.d.p=requestAnimationFrame(this.ha))},kb:function(a){if(2==a.touches.length)return Math.Da(a.touches[0].clientX-a.touches[1].clientX,a.touches[0].clientY-a.touches[1].clientY)/Math.Da(this.Y.offsetWidth,this.Y.offsetHeight)},jb:function(a){this.a.j.$[0]=Math.min(a.touches[0].clientX,a.touches[1].clientX);this.a.j.$[1]=Math.min(a.touches[0].clientY,a.touches[1].clientY);this.a.j.Ba[0]=Math.max(a.touches[0].clientX,a.touches[1].clientX);this.a.j.Ba[1]=Math.max(a.touches[0].clientY,
a.touches[1].clientY);return[this.a.j.$[0]+(this.a.j.Ba[0]-this.a.j.$[0])/2,this.a.j.$[1]+(this.a.j.Ba[1]-this.a.j.$[1])/2]},Aa:function(a){if(this.T||2!=a.touches.length)return this.fa(a);a.stopPropagation();a.preventDefault();this.f.stop();this.T=!0;this.a.j.vb=this.kb(a);this.a.j.wb=this.f.k;this.a.j.eb=this.f.C(this.jb(a),!0);this.b.e.addEventListener("touchmove",this.za);this.b.e.addEventListener("touchend",this.fa);this.b.e.classList.add("pinching")},za:function(a){cancelAnimationFrame(this.a.j.p);
a.stopPropagation();a.preventDefault();this.a.j.L=a;this.a.j.p=requestAnimationFrame(this.Wa)},Wa:function(a){a=this.a.j.L;this.a.j.Ka=this.kb(a);if(this.a.j.Ka){this.f.G(this.a.j.wb*(this.a.j.Rb=this.a.j.Ka/this.a.j.vb));var b=this.f.ta(this.a.j.eb,!0);a=this.jb(a);this.f.s(b[0]-a[0],b[1]-a[1]);this.f.D()}},fa:function(){this.T&&(this.T=!1,this.b.e.removeEventListener("touchmove",this.za),this.b.e.removeEventListener("touchend",this.fa),this.b.e.classList.remove("pinching"))},J:function(a){this.R||
this.T||(a.preventDefault(),this.a.J.L=a,this.f.stop(),this.a.J.p=requestAnimationFrame(this.Za))},Za:function(a){a=this.a.J.L;var b=this.f.C([a.clientX,a.clientY],!0);this.f.zoom(this.Sa?30*-a.detail:a.wheelDelta);b=this.f.ta(b,!0);this.f.s(b[0]-a.clientX,b[1]-a.clientY);this.f.D()},oa:function(a){this.f.stop();1==this.f.k?this.b.l&&this.b.l.qb&&this.b.l.B||this.f.La(0.5,0.5,this.f.P,1E3):(a=this.f.C([a.clientX,a.clientY],!0),this.f.La(a[0],a[1],2.5*this.f.k,400))},wa:function(a){if(!this.R&&!this.T){switch(a.keyCode){case 37:this.f.s(-this.Y.offsetWidth/
2,0);break;case 39:this.f.s(this.Y.offsetWidth/2,0);break;case 38:this.f.s(0,-this.Y.offsetHeight/2);break;case 40:this.f.s(0,this.Y.offsetHeight/2);break;case 187:case 61:a.shiftKey&&this.f.zoom(120,!0);break;case 189:case 173:this.f.zoom(-120,!0);break;default:return}this.f.stop();this.f.D()}},ia:function(a){"A"==a.target.tagName&&(a.target.href&&!a.target.href.indexOf(location.href.replace(/#.*/,"#")))&&(this.a.hash.ja=!0)},ea:function(a){if(this.a.hash.ja||this.a.hash.Ta)this.a.hash.M=location.hash.substr(1).split(","),
3==this.a.hash.M.length&&(this.a.hash.Fb=this.a.hash.M,this.f.stop(),a&&a.preventDefault(),this.a.hash.Ta?(this.f.G(this.a.hash.M[2],!0),this.f.W(this.a.hash.M)):this.f.ra(this.a.hash.M[0],this.a.hash.M[1],this.a.hash.M[2])),this.a.hash.Ta=!1,this.a.hash.ja=!1}};c.g.Q.prototype.hook=c.g.Q.prototype.ua;c.g.Q.prototype.unhook=c.g.Q.prototype.Fa})();

// MS PointerEvents
/*! Copyright (c) Andrea Giammarchi - MIT License */
(function(d,f,l){function v(a){this._=a;this.currentTarget=a.currentTarget}if(!(!(l=!!d.pointerEnabled)&&!d.msPointerEnabled||"ontouchend"in f)){var w=l?"setPointerCapture":"msSetPointerCapture",x=l?"releasePointerCapture":"msReleasePointerCapture";d=Element.prototype;var m=Object.defineProperties,y=Object.defineProperty,n=function(a){var b=a.toLowerCase();a="MS"+a;t[a]=t[b];return l?b:a},g=function(a){return{value:function(){C[a].call(this);this._[a]()}}},p=function(a){var b="_on"+a;return{enumerable:!0,
configurable:!0,get:function(){return this[b]||null},set:function(e){this[b]&&this.removeEventListener(a,this[b]);(this[b]=e)&&this.addEventListener(a,e)}}},q=function(a,b){var e=a[b];y(a,b,{configurable:!0,value:function(a,b,c){a in h&&e.call(this,h[a],D,c);e.call(this,a,b,c)}})},c=function(a){return{get:function(){return this._[a]}}},z=function(a){return function(b){var e=b.pointerId,c=k[e],d=b.currentTarget;delete k[e];if(x in d)d[x](b.pointerId);u(a,b,c);delete r[e]}},u=function(a,b,e){var c=
f.createEvent("Event");c.initEvent(a,!0,!0);s.value=b;A.currentTarget.value=e&&e.currentTarget;m(c,A);e&&e.currentTarget.dispatchEvent(c)},B=function(a,b){function c(a){return b[a]}return function(){s.value=Object.keys(b).map(c);return y(this,a,s)[a]}},s={value:null},k=Object.create(null),r=Object.create(null),C=f.createEvent("Event"),A={_:s,touches:{configurable:!0,get:B("touches",k)},changedTouches:{configurable:!0,get:B("changedTouches",r)},currentTarget:{value:null},relatedTarget:c("relatedTarget"),
target:c("target"),altKey:c("altKey"),metaKey:c("metaKey"),ctrlKey:c("ctrlKey"),shiftKey:c("shiftKey"),preventDefault:g("preventDefault"),stopPropagation:g("stopPropagation"),stopImmediatePropagation:g("stopImmediatePropagation")},h=Object.create(null),D=function(a){var b;a:{switch(a.pointerType){case "mouse":case a.MSPOINTER_TYPE_MOUSE:b="mouse";break a}b="touch"}if("touch"===b)t[a.type](a)},t={pointerdown:function(a){var b=new v(a),c=a.pointerId,d=a.currentTarget;r[c]=k[c]=b;if(w in d)d[w](a.pointerId);
u("touchstart",a,b)},'pointermove':function(a){var b=a.pointerId,c=k[b];c._=a;u("touchmove",a,c);r[b]._=a},'pointerup':z("touchend"),'pointercancel':z("touchcancel")},g={'ontouchstart':p("touchstart"),'ontouchmove':p("touchmove"),'ontouchend':p("touchend"),'ontouchcancel':p("touchcancel")};m(v.prototype,{identifier:c("pointerId"),target:c("target"),screenX:c("screenX"),screenY:c("screenY"),clientX:c("clientX"),clientY:c("clientY"),pageX:c("pageX"),pageY:c("pageY")});h['touchstart']=n("PointerDown");h['touchmove']=n("PointerMove");
h['touchend']=n("PointerUp");h['touchcancel']=n("PointerCancel");q(f,"addEventListener");q(f,"removeEventListener");q(d,"addEventListener");q(d,"removeEventListener");m(f,g);m(d,g)}})(navigator,document);

/*! promise-polyfill 2.0.1 */
!function(a){function b(a,b){return function(){a.apply(b,arguments)}}function c(a){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],i(a,b(e,this),b(f,this))}function d(a){var b=this;return null===this._state?void this._deferreds.push(a):void j(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c)return void(b._state?a.resolve:a.reject)(b._value);var d;try{d=c(b._value)}catch(e){return void a.reject(e)}a.resolve(d)})}function e(a){try{if(a===this)throw new TypeError("A promise cannot be resolved with itself.");if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void i(b(c,a),b(e,this),b(f,this))}this._state=!0,this._value=a,g.call(this)}catch(d){f.call(this,d)}}function f(a){this._state=!1,this._value=a,g.call(this)}function g(){for(var a=0,b=this._deferreds.length;b>a;a++)d.call(this,this._deferreds[a]);this._deferreds=null}function h(a,b,c,d){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.resolve=c,this.reject=d}function i(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){if(d)return;d=!0,c(e)}}var j=c.immediateFn||"function"==typeof setImmediate&&setImmediate||function(a){setTimeout(a,1)},k=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};c.prototype["catch"]=function(a){return this.then(null,a)},c.prototype.then=function(a,b){var e=this;return new c(function(c,f){d.call(e,new h(a,b,c,f))})},c.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&k(arguments[0])?arguments[0]:arguments);return new c(function(b,c){function d(f,g){try{if(g&&("object"==typeof g||"function"==typeof g)){var h=g.then;if("function"==typeof h)return void h.call(g,function(a){d(f,a)},c)}a[f]=g,0===--e&&b(a)}catch(i){c(i)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})},c.resolve=function(a){return a&&"object"==typeof a&&a.constructor===c?a:new c(function(b){b(a)})},c.reject=function(a){return new c(function(b,c){c(a)})},c.race=function(a){return new c(function(b,c){for(var d=0,e=a.length;e>d;d++)a[d].then(b,c)})},"undefined"!=typeof module&&module.exports?module.exports=c:a.Promise||(a.Promise=c)}(this);
